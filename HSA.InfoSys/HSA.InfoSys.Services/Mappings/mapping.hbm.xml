<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                    assembly="Services"
                    namespace="HSA.InfoSys.Common.Services.Data">

  <class name="Entity" table="Entity">
    <id name="EntityId">
      <generator class="guid.comb" />
    </id>

    <property name="Type" type="string" length="50" not-null="true" />

    <!-- Component -->
    <joined-subclass name="Component" table="Component">
      <key column="ComponentGUID" />

      <many-to-one class="Result" name="Result" column="ResultGUID" lazy="proxy" cascade="save-update" />
      <many-to-one name="OrgUnit" class="OrgUnit" column="OrgUnitGuid" lazy="proxy" cascade="save-update" not-null="true" />

      <property name="Name" type="string" length ="100" not-null="true" />
    </joined-subclass>

    <!-- Result -->
    <joined-subclass name="Result" table="Result">
      <key column="ResultGUID" />

      <many-to-one name="Component" class="Component" column="ComponentGuid" lazy="proxy" cascade="save-update" not-null="true" />

      <property name="Content" type="string" >
        <column name="Content" sql-type="text" not-null="false" />
      </property>

      <property name="Title" type="string" length="128" not-null="true" />
      <property name="URL" type="string" length="1024" not-null="true" />
      <property name="Time" type="timestamp" column="FindDate" not-null="true"/>
    </joined-subclass>

    <!-- OrgUnit -->
    <joined-subclass name="OrgUnit" table="OrgUnit">
      <key column="OrgUnitGUID" />

      <many-to-one name="OrgUnitConfig" class="OrgUnitConfig" column="OrgUnitConfigGUID" lazy="proxy" cascade="save-update" />

      <property name="Name" type="string" length ="40" not-null="true" />
      <property name="UserId" type="int" length="10" not-null="true"/>

    </joined-subclass>

    <!-- OrgUnitConfig -->
    <joined-subclass name="OrgUnitConfig" table="OrgUnitConfig">
      <key column="OrgUnitConfigGUID" />

      <property name="Emails" type="string">
        <column name="Emails" sql-type="text" not-null="false"/>
      </property>

      <property name="URLS" type="string" >
        <column name="URLS" sql-type="text" not-null="false" />
      </property>

      <property name="URLActive" type="bool" not-null="true"/>
      <property name="EmailActive" type="bool" not-null="true"/>
      
      <property name="Days" type="int" not-null="true"/>
      <property name="Time" type="int" not-null="true"/>
      <property name="NextSearch" type="timestamp" not-null="false"/>
      
      <property name="SchedulerActive" type="bool" not-null="true"/>
    </joined-subclass>
  </class>
</hibernate-mapping>
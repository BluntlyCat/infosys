<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                    assembly="HSA.InfoSys.DBManager"
                    namespace="HSA.InfoSys.Common.DBManager.Data">

  <!-- Component -->
  <class name="Component" table="Component">
    <id name="EntityId" column="ComponentGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <many-to-one class="Result" name="Result" column="ResultGUID" cascade="save-update" />
    
    <property name="Category" type="string" length ="100" not-null="true" />
    <property name="Name" type="string" length ="100" not-null="true" />
  </class>

  <!-- Result -->
  <class name="Result" table="Result">
    <id name="EntityId" column="ResultGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <property name="Data" type="string" >
      <column name="Data" sql-type="text" not-null="true" />
    </property>
    <property name="TimeStamp" type="timestamp" not-null="true"/>
  </class>

  <!-- Scheduler -->
  <class name="Scheduler" table="Scheduler">
    <id name="EntityId" column="SchedulerGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <property name="Days" type="int" column="Days" not-null="true"/>
    <property name="Hours" type="int" column="Hours" not-null="true"/>
    <property name="TimeStamp" type="timestamp" column="Timestamp" not-null="true"/>
  </class>

  <!-- SystemService -->
  <class name="SystemService" table="SystemService">
    <id name="EntityId" column="SystemServiceGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <many-to-one name="Component" class="Component" column="ComponentGUID" />
    <many-to-one name="SystemConfig" class="SystemConfig" column="SystemconfigGUID" />
    
    <property name="UserId" type="int" column="UserId" length="10" not-null="true"/>
    <property name="TimeStamp" type="timestamp" column="Timestamp" not-null="true"/>
    
  </class>

  <!-- SystemConfig -->
  <class name="SystemConfig" table="SystemConfig">
    <id name="EntityId" column="SystemConfigGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <many-to-one name="Scheduler" class="Scheduler" column="SchedulerGUID" />

    <property name="Email" type="string">
      <column name="Email" sql-type="text" not-null="false"/>
    </property>
    
    <property name="URL" type="string" >
      <column name="URL" length ="2043" not-null="true" />
    </property>
    
    <property name="URLActive" type="bool" column="URLActive" not-null="true"/>
    <property name="EmailNotification" type="bool" column="EmailNotification" not-null="true"/>
    <property name="SchedulerActive" type="bool" column="SchedulerActive" not-null="true"/>
  </class>

  <!-- Issue -->
  <class name ="Issue" table="Issue">
    <id name="EntityId" column="IssueGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <many-to-one name="Component" class="Component" column="ComponentGUID" />
    <many-to-one name="Source" class="Source" column="SourceGUID" />

    <property name="Text" type="string">
      <column name="text" sql-type="mediumtext" length="16777215" not-null="false"/>
    </property>
    
    <property name="Title" type="string" length ="40" not-null="true"/>
    <property name="ThreatLevel" type="int" length ="11" not-null="true"/>
    <property name="Date" type="date" not-null="true"/>
  </class>

  <!-- Source -->
  <class name="Source" table="Source">
    <id name="EntityId" column="SourceGUID" type="guid">
      <generator class="guid.comb" />
    </id>

    <property name="URL" type="string" >
      <column name="URL" length ="2043" not-null="true" />
    </property>
  </class>
</hibernate-mapping>
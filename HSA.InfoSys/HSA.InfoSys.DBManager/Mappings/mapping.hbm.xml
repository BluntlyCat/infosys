<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                    assembly="HSA.InfoSys.DBManager"
                    namespace="HSA.InfoSys.Common.DBManager.Data">

  <class name="Entity" table="Entity">
    <id name="EntityId">
      <generator class="guid.comb" />
    </id>

    <property name="Type" type="string" length="50" not-null="true" />

    <!-- Component -->
    <joined-subclass name="Component" table="Component">
      <key column="ComponentGUID" />

      <many-to-one class="Result" name="Result" column="ResultGUID" cascade="save-update" />

      <property name="Name" type="string" length ="100" not-null="true" />
    </joined-subclass>

    <!-- Result -->
    <joined-subclass name="Result" table="Result">
      <key column="ResultGUID" />

      <property name="Data" type="string" >
        <column name="Data" sql-type="text" not-null="false" />
      </property>

      <property name="Source" type="string" length="1024" not-null="true" />
      <property name="Time" type="timestamp" column="FindDate" not-null="true"/>
    </joined-subclass>

    <!-- Scheduler -->
    <joined-subclass name="Scheduler" table="Scheduler">
      <key column="SchedulerGUID" />

      <property name="Days" type="int" not-null="true"/>
      <property name="Hours" type="int" not-null="true"/>
      <property name="Begin" type="timestamp" not-null="true"/>
    </joined-subclass>

    <!-- SystemService -->
    <joined-subclass name="SystemService" table="SystemService">
      <key column="SystemServiceGUID" />

      <many-to-one name="Component" class="Component" column="ComponentGUID" cascade="save-update" />
      <many-to-one name="SystemConfig" class="SystemConfig" column="SystemConfigGUID" cascade="save-update" />

      <property name="Name" type="string" length ="40" not-null="true" />
      <property name="UserId" type="int" length="10" not-null="true"/>
      <property name="NextSearch" type="timestamp" not-null="false"/>

    </joined-subclass>

    <!-- SystemConfig -->
    <joined-subclass name="SystemConfig" table="SystemConfig">
      <key column="SystemConfigGUID" />

      <many-to-one name="Scheduler" class="Scheduler" column="SchedulerGUID" cascade="save-update" />

      <property name="Emails" type="string">
        <column name="Emails" sql-type="text" not-null="false"/>
      </property>

      <property name="URLS" type="string" >
        <column name="URLS" sql-type="text" not-null="false" />
      </property>

      <property name="URLActive" type="bool" not-null="true"/>
      <property name="EmailActive" type="bool" not-null="true"/>
      <property name="SchedulerActive" type="bool" not-null="true"/>
    </joined-subclass>
  </class>
</hibernate-mapping>